<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0061)http://www.codeproject.com/useritems/UserFileAccessRights.asp -->
<HTML><HEAD><TITLE>Testing file access rights in .NET 2.0 - The Code Project - C# Samples</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="A simple way to test individual access rights for a given file and user" 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Bruce Hatt" name=Author>
<META content="08 Jun 2006 14:00:00 GMT" name=Search.PublishDate>
<META content="12 Jul 2006 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, ACL, Security" 
name=keywords>
<META 
content="Article content copyright Bruce Hatt, 2006, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- BEGIN I/PRO PAGE TAG - COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. -->
<SCRIPT language=JavaScript> 
var LSPT=""; 
LSPT += "?durl=" + escape(document.URL); 
LSPT += "&hostname=" + location.hostname; 
LSPT += "&url=" + location.pathname; 
LSPT += "&query=" + escape(location.search) + escape(location.hash); 
LSPT += "&referrer=" + escape(document.referrer); 
LSPT += "&browser=" + escape(navigator.appName); 
LSPT += "&version=" + escape(navigator.appVersion); 
LSPT += "&os=" + escape(navigator.platform); 
LSPT += "&xdomain=codeproject.com"; 
LSPT += "&custid=codeproject"; 
</SCRIPT>

<SCRIPT language=Javascript> 
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute;top:0px;left:0px">'); 
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 
src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/pixel.gif" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2788&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvista%5Fapi%5Fcp%5Fcompetition%5F728x90v4%2Egif&C=False&id=2788&cb=8311053\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,783,977 members and 
            growing! &nbsp; 6,314 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2884322">Marcelo 
            Oviedo </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/useritems/UserFileAccessRights.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2884322">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/useritems/UserFileAccessRights.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleUneditedHeader cellSpacing=0 cellPadding=3 
      width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/samples/">C# Samples</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/samples/#Unedited+Reader+Contributions">Unedited 
            Reader Contributions</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Testing file access 
            rights in .NET 2.0</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=2908096">Bruce 
            Hatt</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">A simple way to test individual access 
            rights for a given file and user</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">Generic<BR>Windows, 
            .NET<BR>ASP.NET, Win32, VS<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>9 Jun 2006 
            </B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>13 Jul 
            2006</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>11,536</B> </TD></TR>
        <TR class=ArticleUneditedHeader>
          <TD colSpan=2>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=smallText width="100%"><B>Note: <A 
                  title="Click here for more information" 
                  href="http://www.codeproject.com/info/unedited.asp">This is an 
                  unedited reader contribution</B></A> </TD>
                <TD class=SmallText noWrap><A 
                  href="http://www.codeproject.com/script/Submit/EditArticle1.asp?guid=UserFileAccessRights%2Faspnet6%2F9%2F2006">Modify</A> 
                  | <A 
                  href="http://www.codeproject.com/script/Submit/DeleteArticle1.asp?guid=UserFileAccessRights%2Faspnet6%2F9%2F2006">Delete</A>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left" height=20 alt=Vista 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/vista20.gif" 
            width=20> <A 
            href="http://www.codeproject.com/redir.aspx?id=2666">Vista API 
            competition<BR>$10,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left" height=20 alt=Vista 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/gadgets20.gif" 
            width=20> <A 
            href="http://www.codeproject.com/redir.aspx?id=2848">Vista Gadget 
            comp: $2,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2763&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FInfragistics%5Fnetadv2006vol3ASP%5F160x600%2Egif&C=False&id=2763&cb=8311065\" alt=\"Infragistics NetAdvantage\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=UserFileAccessRights%2Faspnet6%2F9%2F2006">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fuseritems%2FUserFileAccessRights%2Easp&amp;guid=UserFileAccessRights%2Faspnet6%2F9%2F2006">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/useritems/UserFileAccessRights.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=UserFileAccessRights%2Faspnet6%2F9%2F2006">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>14 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/red.gif" 
                              width=4 border=0><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/white.gif" 
                              width=16 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        4.81</A>. Rating: <B>4.2</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane>
            <P class=smallText 
            style="PADDING-RIGHT: 5px; BORDER-TOP: #ff9900 1px dashed; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 5px; PADDING-TOP: 5px; BORDER-BOTTOM: #ff9900 1px dashed" 
            ?><B>Note:</B> This is an unedited contribution. If this article is 
            inappropriate, needs attention or copies someone else's work without 
            reference then please <A 
            href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=UserFileAccessRights%2Faspnet6%2F9%2F2006">Report 
            this article</A>.</P><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <P><IMG height=85 alt=Coder 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/w.gif" 
            width=112></P>
            <H2>Introduction</H2>
            <P>The purpose of this class is to provide a simple answer to a 
            common question, "Do I have permission to Read or Write this file?". 

            <P>The code was developed for a web based configuration utility. 
            Knowing if write access was available in advance is helpful and a 
            bit nicer than simply throwing an exception. 
            <P>To use it, simply instantiate one with the path and an optional 
            user and you can use the accessors to determine if you have the 
            access you need. 
            <P><PRE lang=cs>UserFileAccessRights rights = <SPAN class=cs-keyword>new</SPAN> UserFileAccessRights(txtLogPath.Text);
 <SPAN class=cs-keyword>if</SPAN> (rights.canWrite() &amp;&amp; rights.canRead()) {
     lblLogMsg.Text = <SPAN class=cpp-string>"R/W access"</SPAN>;
 } <SPAN class=cs-keyword>else</SPAN> {
     <SPAN class=cs-keyword>if</SPAN> (rights.canWrite()) {
        lblLogMsg.Text = <SPAN class=cpp-string>"Only Write access"</SPAN>;
     } <SPAN class=cs-keyword>else</SPAN> <SPAN class=cs-keyword>if</SPAN> (rights.canRead()) {
         lblLogMsg.Text = <SPAN class=cpp-string>"Only Read access"</SPAN>;
     } <SPAN class=cs-keyword>else</SPAN> {
         lblLogMsg.CssClass = <SPAN class=cpp-string>"error"</SPAN>;
         lblLogMsg.Text = rights.ToString()
     }
 }
</PRE>A check is done to see if a deny rule is found at the user 
            level and the groups one level up. 
            <P>One could recursively check groups and provide more detail with 
            respect to inheritance so feel free to modify as you wish. <PRE lang=cs><SPAN class=cs-keyword>using</SPAN> System;
<SPAN class=cs-keyword>using</SPAN> System.Security;
<SPAN class=cs-keyword>using</SPAN> System.Security.AccessControl;
<SPAN class=cs-keyword>using</SPAN> System.Security.Principal;


<SPAN class=cs-keyword>namespace</SPAN> GCAWeb.Utils{

    <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
    <SPAN class=cs-comment>/// Configuring a website through a web interface can be tricky. If one is to read and write</SPAN>
    <SPAN class=cs-comment>/// various files, it is useful to know in advance if you have the authority to do so.</SPAN>
    <SPAN class=cs-comment>/// </SPAN>
    <SPAN class=cs-comment>/// This class contains a simple answer to a </SPAN>
    <SPAN class=cs-comment>/// potentially complicated question "Can I read this file or can I write to this file?"</SPAN>
    <SPAN class=cs-comment>/// </SPAN>
    <SPAN class=cs-comment>/// Using the "rule of least privilege", one must check not only is access granted but </SPAN>
    <SPAN class=cs-comment>/// is it denied at any point including a possibly recursive check of groups.</SPAN>
    <SPAN class=cs-comment>/// </SPAN>
    <SPAN class=cs-comment>/// For this simple check, a look at the user and immediate groups are only checked.</SPAN>
    <SPAN class=cs-comment>/// </SPAN>
    <SPAN class=cs-comment>/// This class could be expanded to identify if the applicable allow/deny rule</SPAN>
    <SPAN class=cs-comment>/// was explicit or inherited</SPAN>
    <SPAN class=cs-comment>/// </SPAN>
    <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
    <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>class</SPAN> UserFileAccessRights {

        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>string</SPAN> _path;
        <SPAN class=cs-keyword>private</SPAN> System.Security.Principal.WindowsIdentity _principal;

        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyAppendData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyChangePermissions = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyCreateDirectories = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyCreateFiles = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyDelete = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyExecuteFile = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyFullControl = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyListDirectory = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyModify = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyRead = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyReadAndExecute = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyReadAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyReadData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyReadExtendedAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyReadPermissions = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denySynchronize = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyTakeOwnership = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyTraverse = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyWrite = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyWriteAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyWriteData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _denyWriteExtendedAttributes = <SPAN class=cs-keyword>false</SPAN>;


        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowAppendData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowChangePermissions = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowCreateDirectories = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowCreateFiles = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowDelete = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowExecuteFile = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowFullControl = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowListDirectory = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowModify = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowRead = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowReadAndExecute = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowReadAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowReadData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowReadExtendedAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowReadPermissions = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowSynchronize = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowTakeOwnership = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowTraverse = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowWrite = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowWriteAttributes = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowWriteData = <SPAN class=cs-keyword>false</SPAN>;
        <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>bool</SPAN> _allowWriteExtendedAttributes = <SPAN class=cs-keyword>false</SPAN>;


        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canAppendData() { <SPAN class=cs-keyword>return</SPAN> !_denyAppendData&amp;&amp;_allowAppendData; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canChangePermissions() { <SPAN class=cs-keyword>return</SPAN> !_denyChangePermissions&amp;&amp;_allowChangePermissions; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canCreateDirectories() { <SPAN class=cs-keyword>return</SPAN> !_denyCreateDirectories&amp;&amp;_allowCreateDirectories; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canCreateFiles() { <SPAN class=cs-keyword>return</SPAN> !_denyCreateFiles&amp;&amp;_allowCreateFiles; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canDelete() { <SPAN class=cs-keyword>return</SPAN> !_denyDelete &amp;&amp; _allowDelete; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canDeleteSubdirectoriesAndFiles() { <SPAN class=cs-keyword>return</SPAN> !_denyDeleteSubdirectoriesAndFiles &amp;&amp; _allowDeleteSubdirectoriesAndFiles; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canExecuteFile() { <SPAN class=cs-keyword>return</SPAN> !_denyExecuteFile &amp;&amp; _allowExecuteFile; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canFullControl() { <SPAN class=cs-keyword>return</SPAN> !_denyFullControl &amp;&amp; _allowFullControl; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canListDirectory() { <SPAN class=cs-keyword>return</SPAN> !_denyListDirectory &amp;&amp; _allowListDirectory; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canModify() { <SPAN class=cs-keyword>return</SPAN> !_denyModify &amp;&amp; _allowModify; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canRead() { <SPAN class=cs-keyword>return</SPAN> !_denyRead &amp;&amp; _allowRead; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canReadAndExecute() { <SPAN class=cs-keyword>return</SPAN> !_denyReadAndExecute &amp;&amp; _allowReadAndExecute; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canReadAttributes() { <SPAN class=cs-keyword>return</SPAN> !_denyReadAttributes &amp;&amp; _allowReadAttributes; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canReadData() { <SPAN class=cs-keyword>return</SPAN> !_denyReadData &amp;&amp; _allowReadData; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canReadExtendedAttributes() { <SPAN class=cs-keyword>return</SPAN> !_denyReadExtendedAttributes &amp;&amp; _allowReadExtendedAttributes; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canReadPermissions() { <SPAN class=cs-keyword>return</SPAN> !_denyReadPermissions &amp;&amp; _allowReadPermissions; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canSynchronize() { <SPAN class=cs-keyword>return</SPAN> !_denySynchronize &amp;&amp; _allowSynchronize; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canTakeOwnership() { <SPAN class=cs-keyword>return</SPAN> !_denyTakeOwnership &amp;&amp; _allowTakeOwnership; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canTraverse() { <SPAN class=cs-keyword>return</SPAN> !_denyTraverse &amp;&amp; _allowTraverse; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canWrite() { <SPAN class=cs-keyword>return</SPAN> !_denyWrite &amp;&amp; _allowWrite; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canWriteAttributes() { <SPAN class=cs-keyword>return</SPAN> !_denyWriteAttributes &amp;&amp; _allowWriteAttributes; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canWriteData() { <SPAN class=cs-keyword>return</SPAN> !_denyWriteData &amp;&amp; _allowWriteData; }
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> canWriteExtendedAttributes() { <SPAN class=cs-keyword>return</SPAN> !_denyWriteExtendedAttributes &amp;&amp; _allowWriteExtendedAttributes; }


        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Simple accessor</SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;returns&gt;&lt;/returns&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> System.Security.Principal.WindowsIdentity getWindowsIdentity() {
            <SPAN class=cs-keyword>return</SPAN> _principal;
        }
        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Simple accessor</SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;returns&gt;&lt;/returns&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> String getPath() {
            <SPAN class=cs-keyword>return</SPAN> _path;
        }

        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Convenience constructor assumes the current user</SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;param name="path"&gt;&lt;/param&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> UserFileAccessRights(<SPAN class=cs-keyword>string</SPAN> path) :
            <SPAN class=cs-keyword>this</SPAN>(path, System.Security.Principal.WindowsIdentity.GetCurrent()){}


        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Supply the path to the file or directory and a user or group. Access checks are done</SPAN>
        <SPAN class=cs-comment>/// during instanciation to ensure we always have a valid object</SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;param name="path"&gt;&lt;/param&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;param name="principal"&gt;&lt;/param&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> UserFileAccessRights(<SPAN class=cs-keyword>string</SPAN> path, System.Security.Principal.WindowsIdentity principal) {
            <SPAN class=cs-keyword>this</SPAN>._path = path;
            <SPAN class=cs-keyword>this</SPAN>._principal = principal;
                        
            <SPAN class=cs-keyword>try</SPAN> {
                System.IO.FileInfo fi = <SPAN class=cs-keyword>new</SPAN> System.IO.FileInfo(_path);
                AuthorizationRuleCollection acl = fi.GetAccessControl().GetAccessRules(<SPAN class=cs-keyword>true</SPAN>, <SPAN class=cs-keyword>true</SPAN>, <SPAN class=cs-keyword>typeof</SPAN>(SecurityIdentifier));
                <SPAN class=cs-keyword>for</SPAN> (<SPAN class=cs-keyword>int</SPAN> i = <SPAN class=cs-literal>0</SPAN>; i &lt; acl.Count; i++) {
                    System.Security.AccessControl.FileSystemAccessRule rule = (System.Security.AccessControl.FileSystemAccessRule)acl[i];
                    <SPAN class=cs-keyword>if</SPAN> (_principal.User.Equals(rule.IdentityReference)) {
                        <SPAN class=cs-keyword>if</SPAN> (System.Security.AccessControl.AccessControlType.Deny.Equals(rule.AccessControlType)) {
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.AppendData,rule)) _denyAppendData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ChangePermissions,rule)) _denyChangePermissions = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateDirectories,rule)) _denyCreateDirectories = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateFiles,rule)) _denyCreateFiles = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Delete,rule)) _denyDelete = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.DeleteSubdirectoriesAndFiles,rule)) _denyDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ExecuteFile,rule)) _denyExecuteFile = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.FullControl,rule)) _denyFullControl = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ListDirectory,rule)) _denyListDirectory = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Modify,rule)) _denyModify = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Read,rule)) _denyRead = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAndExecute,rule)) _denyReadAndExecute = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAttributes,rule)) _denyReadAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadData,rule)) _denyReadData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadExtendedAttributes,rule)) _denyReadExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadPermissions,rule)) _denyReadPermissions = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Synchronize,rule)) _denySynchronize = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.TakeOwnership,rule)) _denyTakeOwnership = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Traverse,rule)) _denyTraverse = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Write,rule)) _denyWrite = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteAttributes,rule)) _denyWriteAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteData,rule)) _denyWriteData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteExtendedAttributes,rule)) _denyWriteExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                        }<SPAN class=cs-keyword>else</SPAN> <SPAN class=cs-keyword>if</SPAN> (System.Security.AccessControl.AccessControlType.Allow.Equals(rule.AccessControlType)) {
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.AppendData, rule))_allowAppendData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ChangePermissions, rule))_allowChangePermissions = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateDirectories, rule))_allowCreateDirectories = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateFiles, rule))_allowCreateFiles = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Delete, rule))_allowDelete = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.DeleteSubdirectoriesAndFiles, rule))_allowDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ExecuteFile, rule))_allowExecuteFile = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.FullControl, rule))_allowFullControl = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ListDirectory, rule))_allowListDirectory = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Modify, rule))_allowModify = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Read, rule))_allowRead = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAndExecute, rule))_allowReadAndExecute = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAttributes, rule))_allowReadAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadData, rule))_allowReadData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadExtendedAttributes, rule))_allowReadExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadPermissions, rule))_allowReadPermissions = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Synchronize, rule))_allowSynchronize = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.TakeOwnership, rule))_allowTakeOwnership = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Traverse, rule))_allowTraverse = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Write, rule))_allowWrite = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteAttributes, rule))_allowWriteAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteData, rule))_allowWriteData = <SPAN class=cs-keyword>true</SPAN>;
                            <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteExtendedAttributes, rule))_allowWriteExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                        }
                    }
                }

                IdentityReferenceCollection groups = _principal.Groups;
                <SPAN class=cs-keyword>for</SPAN> (<SPAN class=cs-keyword>int</SPAN> j = <SPAN class=cs-literal>0</SPAN>; j &lt; groups.Count; j++) {
                    <SPAN class=cs-keyword>for</SPAN> (<SPAN class=cs-keyword>int</SPAN> i = <SPAN class=cs-literal>0</SPAN>; i &lt; acl.Count; i++) {
                        System.Security.AccessControl.FileSystemAccessRule rule = (System.Security.AccessControl.FileSystemAccessRule)acl[i];
                        <SPAN class=cs-keyword>if</SPAN> (groups[j].Equals(rule.IdentityReference)) {
                            <SPAN class=cs-keyword>if</SPAN> (System.Security.AccessControl.AccessControlType.Deny.Equals(rule.AccessControlType)) {
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.AppendData,rule)) _denyAppendData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ChangePermissions,rule)) _denyChangePermissions = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateDirectories,rule)) _denyCreateDirectories = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateFiles,rule)) _denyCreateFiles = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Delete,rule)) _denyDelete = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.DeleteSubdirectoriesAndFiles,rule)) _denyDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ExecuteFile,rule)) _denyExecuteFile = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.FullControl,rule)) _denyFullControl = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ListDirectory,rule)) _denyListDirectory = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Modify,rule)) _denyModify = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Read,rule)) _denyRead = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAndExecute,rule)) _denyReadAndExecute = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAttributes,rule)) _denyReadAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadData,rule)) _denyReadData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadExtendedAttributes,rule)) _denyReadExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadPermissions,rule)) _denyReadPermissions = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Synchronize,rule)) _denySynchronize = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.TakeOwnership,rule)) _denyTakeOwnership = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Traverse,rule)) _denyTraverse = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Write,rule)) _denyWrite = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteAttributes,rule)) _denyWriteAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteData,rule)) _denyWriteData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteExtendedAttributes,rule)) _denyWriteExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            }<SPAN class=cs-keyword>else</SPAN> <SPAN class=cs-keyword>if</SPAN> (System.Security.AccessControl.AccessControlType.Allow.Equals(rule.AccessControlType)) {
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.AppendData, rule))_allowAppendData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ChangePermissions, rule))_allowChangePermissions = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateDirectories, rule))_allowCreateDirectories = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.CreateFiles, rule))_allowCreateFiles = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Delete, rule))_allowDelete = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.DeleteSubdirectoriesAndFiles, rule))_allowDeleteSubdirectoriesAndFiles = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ExecuteFile, rule))_allowExecuteFile = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.FullControl, rule))_allowFullControl = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ListDirectory, rule))_allowListDirectory = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Modify, rule))_allowModify = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Read, rule))_allowRead = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAndExecute, rule))_allowReadAndExecute = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadAttributes, rule))_allowReadAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadData, rule))_allowReadData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadExtendedAttributes, rule))_allowReadExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.ReadPermissions, rule))_allowReadPermissions = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Synchronize, rule))_allowSynchronize = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.TakeOwnership, rule))_allowTakeOwnership = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Traverse, rule))_allowTraverse = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.Write, rule))_allowWrite = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteAttributes, rule))_allowWriteAttributes = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteData, rule))_allowWriteData = <SPAN class=cs-keyword>true</SPAN>;
                                <SPAN class=cs-keyword>if</SPAN> (contains(FileSystemRights.WriteExtendedAttributes, rule))_allowWriteExtendedAttributes = <SPAN class=cs-keyword>true</SPAN>;
                            }
                        }
                    }

                }
            } <SPAN class=cs-keyword>catch</SPAN> (Exception e) {
                <SPAN class=cs-comment>//Deal with io exceptions if you want</SPAN>
                <SPAN class=cs-keyword>throw</SPAN> e;
            }

        }

        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Simply displays all allowed rights</SPAN>
        <SPAN class=cs-comment>/// </SPAN>
        <SPAN class=cs-comment>/// Useful if say you want to test for write access and find</SPAN>
        <SPAN class=cs-comment>/// it is false;</SPAN>
        <SPAN class=cs-comment>/// &lt;xmp&gt;</SPAN>
        <SPAN class=cs-comment>/// UserFileAccessRights rights = new UserFileAccessRights(txtLogPath.Text);</SPAN>
        <SPAN class=cs-comment>/// System.IO.FileInfo fi = new System.IO.FileInfo(txtLogPath.Text);</SPAN>
        <SPAN class=cs-comment>/// if (rights.canWrite() &amp;&amp; rights.canRead()) {</SPAN>
        <SPAN class=cs-comment>///     lblLogMsg.Text = "R/W access";</SPAN>
        <SPAN class=cs-comment>/// } else {</SPAN>
        <SPAN class=cs-comment>///     if (rights.canWrite()) {</SPAN>
        <SPAN class=cs-comment>///        lblLogMsg.Text = "Only Write access";</SPAN>
        <SPAN class=cs-comment>///     } else if (rights.canRead()) {</SPAN>
        <SPAN class=cs-comment>///         lblLogMsg.Text = "Only Read access";</SPAN>
        <SPAN class=cs-comment>///     } else {</SPAN>
        <SPAN class=cs-comment>///         lblLogMsg.CssClass = "error";</SPAN>
        <SPAN class=cs-comment>///         lblLogMsg.Text = rights.ToString()</SPAN>
        <SPAN class=cs-comment>///     }</SPAN>
        <SPAN class=cs-comment>/// }</SPAN>
        <SPAN class=cs-comment>/// </SPAN>
        <SPAN class=cs-comment>/// &lt;/xmp&gt;</SPAN>
        <SPAN class=cs-comment>/// </SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;returns&gt;&lt;/returns&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>override</SPAN> String ToString() {
            <SPAN class=cs-keyword>string</SPAN> str = <SPAN class=cpp-string>""</SPAN>;
        
            <SPAN class=cs-keyword>if</SPAN> (canAppendData()) {<SPAN class=cs-keyword>if</SPAN>(!String.IsNullOrEmpty(str)) str+=<SPAN class=cpp-string>","</SPAN>;str+=<SPAN class=cpp-string>"AppendData"</SPAN>;}
            <SPAN class=cs-keyword>if</SPAN> (canChangePermissions()) {<SPAN class=cs-keyword>if</SPAN>(!String.IsNullOrEmpty(str)) str+=<SPAN class=cpp-string>","</SPAN>;str+=<SPAN class=cpp-string>"ChangePermissions"</SPAN>;}
            <SPAN class=cs-keyword>if</SPAN> (canCreateDirectories()) {<SPAN class=cs-keyword>if</SPAN>(!String.IsNullOrEmpty(str)) str+=<SPAN class=cpp-string>","</SPAN>;str+=<SPAN class=cpp-string>"CreateDirectories"</SPAN>;}
            <SPAN class=cs-keyword>if</SPAN> (canCreateFiles()) {<SPAN class=cs-keyword>if</SPAN>(!String.IsNullOrEmpty(str)) str+=<SPAN class=cpp-string>","</SPAN>;str+=<SPAN class=cpp-string>"CreateFiles"</SPAN>;}
            <SPAN class=cs-keyword>if</SPAN> (canDelete()) {<SPAN class=cs-keyword>if</SPAN>(!String.IsNullOrEmpty(str)) str+=<SPAN class=cpp-string>","</SPAN>;str+=<SPAN class=cpp-string>"Delete"</SPAN>;}
            <SPAN class=cs-keyword>if</SPAN> (canDeleteSubdirectoriesAndFiles()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"DeleteSubdirectoriesAndFiles"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canExecuteFile()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ExecuteFile"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canFullControl()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"FullControl"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canListDirectory()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ListDirectory"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canModify()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"Modify"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canRead()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"Read"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canReadAndExecute()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ReadAndExecute"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canReadAttributes()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ReadAttributes"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canReadData()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ReadData"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canReadExtendedAttributes()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ReadExtendedAttributes"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canReadPermissions()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"ReadPermissions"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canSynchronize()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"Synchronize"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canTakeOwnership()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"TakeOwnership"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canTraverse()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"Traverse"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canWrite()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"Write"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canWriteAttributes()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"WriteAttributes"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canWriteData()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"WriteData"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (canWriteExtendedAttributes()) { <SPAN class=cs-keyword>if</SPAN> (!String.IsNullOrEmpty(str)) str += <SPAN class=cpp-string>","</SPAN>; str += <SPAN class=cpp-string>"WriteExtendedAttributes"</SPAN>; }
            <SPAN class=cs-keyword>if</SPAN> (String.IsNullOrEmpty(str))
                str = <SPAN class=cpp-string>"None"</SPAN>;
            <SPAN class=cs-keyword>return</SPAN> str;
        }

        <SPAN class=cs-comment>/// &lt;summary&gt;</SPAN>
        <SPAN class=cs-comment>/// Convenience method to test if the right exists within the given rights</SPAN>
        <SPAN class=cs-comment>/// &lt;/summary&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;param name="right"&gt;&lt;/param&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;param name="rule"&gt;&lt;/param&gt;</SPAN>
        <SPAN class=cs-comment>/// &lt;returns&gt;&lt;/returns&gt;</SPAN>
        <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>bool</SPAN> contains(System.Security.AccessControl.FileSystemRights right,System.Security.AccessControl.FileSystemAccessRule rule ) {
            <SPAN class=cs-keyword>return</SPAN> (((<SPAN class=cs-keyword>int</SPAN>)right &amp; (<SPAN class=cs-keyword>int</SPAN>)rule.FileSystemRights) == (<SPAN class=cs-keyword>int</SPAN>)right);
        }
    
    }
}
</PRE><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>Bruce Hatt</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/{BD3BA231-CD0A-431F-9ED6-14F8A5DFEF01}.jpg"><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=2908096">here</A> 
                  to view Bruce Hatt's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular C# Samples articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/samples/swarmscreensaver.asp">A 
                    complete C# Screensaver that does double-buffering on 
                    multiple monitor systems!</A>
                    <DIV class=smallText>Example screensaver in source code. 
                    Does a mini-preview too!</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/samples/codeprojectquoter.asp">CodeProject 
                    Quoter</A>
                    <DIV class=smallText>Simple tool for storing and retrieving 
                    the quotes and using them in the signatures.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/useritems/ScreenEffect.asp">Screen 
                    Effect (The perfect easter egg)</A>
                    <DIV class=smallText>This little chunk of code will take 
                    your screen and do something neat with it.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/samples/pdf2text.asp">Converting 
                    PDF to Text in C#</A>
                    <DIV class=smallText>Parsing PDF files in .NET using PDFBox 
                    and IKVM.NET (managed code).</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2781&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FMainsoft%5FGHQ3%5F300x250v2%2Egif&C=False&id=2781&cb=8311074\" alt=\"Code .NET / Build Java / Run Linux\" border=0 width=300 height=250></a>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden 
            value=UserFileAccessRights/aspnet6/9/2006 name=vote_name> <INPUT 
            type=hidden value=/useritems/UserFileAccessRights.asp name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/useritems/UserFileAccessRights.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2839&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvista%5Fgadgets%5Fcp%5Fcompetition%5F120x60v4%2Egif&C=False&id=2839&cb=8311076\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3025&cb=8311054\" border=0 frameborder=0 scrolling=no width=468 height=60></IFRAME>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=315432"><IMG 
                              height=15 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 7 of 7 (Total: 7) 
                              (<A 
                              href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1874158_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1874158xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1874158#xx1874158xx" 
                                name=1874158><B>Contains method</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1845250"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>atlaste</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:51 2 Feb 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1874158_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Currently the contains 
                                method maps the FileSystemRights to an int. 
                                Which is fine as long as there are less than 
                                32-bits in use.<BR><BR>A more convenient way of 
                                implementing contains is using the type 
                                directly:<BR><BR>protected bool 
                                contains(System.Security.AccessControl.FileSystemRights 
                                right,System.Security.AccessControl.FileSystemAccessRule 
                                rule ) {<BR>return ((rule.FileSystemRights &amp; 
                                right) == right);<BR>}<BR><BR>(without the 
                                casting) <BR><BR>Cheers,<BR><BR>Stefan de 
                                Bruijn,<BR>Senior search engineer,<BR>Teezir 
                                B.V.<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1874158">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1874158">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1874158&amp;forumid=315432&amp;select=1874158#xx1874158xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1874158#xx1874158xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1845250,1874158);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1643158_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1643158xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1643158#xx1643158xx" 
                                name=1643158><B>Remote machines</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3263174"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>babushaikha</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>17:36 25 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1643158_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This 
                                worked great, obviously you put in a lot of 
                                effort. However, when using it on a remote 
                                machine, and if you are an admin on your local 
                                box, it will always give you read/right access. 
                                Any ideas on this problem?<BR><BR>Thanks 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1643158">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1643158">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1643158&amp;forumid=315432&amp;select=1643158#xx1643158xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1643158#xx1643158xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3263174,1643158);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1587457_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1587457xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1587457#xx1587457xx" 
                                name=1587457><B>Improved version</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=718003"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Khoi N. 
                                Phan</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>13:58 20 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1587457_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                for the code. I thought I could use this code 
                                for my current project so I modify it to make it 
                                more efficient and cleaner as 
                                follow:<BR><BR><BR>public class 
                                UserFileAccess<BR>{<BR>/// <SUMMARY><BR>/// 
                                Convenience constructor assumes the current 
                                user<BR>/// </SUMMARY><BR>/// <PARAM 
                                name="path"></PARAM><BR>public 
                                UserFileAccess(string path)<BR>: this(path, 
                                System.Security.Principal.WindowsIdentity.GetCurrent()) 
                                { }<BR><BR><BR>/// <SUMMARY><BR>/// Supply the 
                                path to the file or directory and a user or 
                                group. Access checks are done<BR>/// during 
                                instanciation to ensure we always have a valid 
                                object<BR>/// </SUMMARY><BR>/// <PARAM 
                                name="path"></PARAM><BR>/// <PARAM 
                                name="principal"></PARAM><BR>public 
                                UserFileAccess(string path, 
                                System.Security.Principal.WindowsIdentity 
                                principal)<BR>{<BR>this._path = 
                                path;<BR>this._principal = 
                                principal;<BR><BR>this.GetAccessRights(_path, 
                                _principal);<BR>}<BR><BR>private string 
                                _path;<BR>private 
                                System.Security.Principal.WindowsIdentity 
                                _principal;<BR>private int _accessCode = 
                                0;<BR><BR>public 
                                System.Security.Principal.WindowsIdentity 
                                WindowsIdentity<BR>{<BR>get { return _principal; 
                                }<BR>set { _principal = value; 
                                this.GetAccessRights(_path, _principal); 
                                }<BR>}<BR><BR>public String Path<BR>{<BR>get { 
                                return _path; }<BR>set { _path = value; 
                                this.GetAccessRights(_path, _principal); 
                                }<BR>}<BR><BR>public bool 
                                HasRight(System.Security.AccessControl.FileSystemRights 
                                right)<BR>{<BR>return (_accessCode &amp; 
                                ((int)right)) != 0;<BR>}<BR><BR>public bool 
                                CanAppendData { get { return 
                                HasRight(FileSystemRights.AppendData); } 
                                }<BR>public bool CanChangePermissions { get { 
                                return 
                                HasRight(FileSystemRights.ChangePermissions); } 
                                }<BR>public bool CanCreateDirectories { get { 
                                return 
                                HasRight(FileSystemRights.CreateDirectories); } 
                                }<BR>public bool CanCreateFiles { get { return 
                                HasRight(FileSystemRights.CreateFiles); } 
                                }<BR>public bool CanDelete { get { return 
                                HasRight(FileSystemRights.Delete); } }<BR>public 
                                bool CanDeleteSubdirectoriesAndFiles { get { 
                                return 
                                HasRight(FileSystemRights.DeleteSubdirectoriesAndFiles); 
                                } }<BR>public bool CanExecuteFile { get { return 
                                HasRight(FileSystemRights.ExecuteFile); } 
                                }<BR>public bool CanFullControl { get { return 
                                HasRight(FileSystemRights.FullControl); } 
                                }<BR>public bool CanListDirectory { get { return 
                                HasRight(FileSystemRights.ListDirectory); } 
                                }<BR>public bool CanModify { get { return 
                                HasRight(FileSystemRights.Modify); } }<BR>public 
                                bool CanRead { get { return 
                                HasRight(FileSystemRights.Read); } }<BR>public 
                                bool CanReadAndExecute { get { return 
                                HasRight(FileSystemRights.ReadAndExecute); } 
                                }<BR>public bool CanReadAttributes { get { 
                                return 
                                HasRight(FileSystemRights.ReadAttributes); } 
                                }<BR>public bool CanReadData { get { return 
                                HasRight(FileSystemRights.ReadData); } 
                                }<BR>public bool CanReadExtendedAttributes { get 
                                { return 
                                HasRight(FileSystemRights.ReadExtendedAttributes); 
                                } }<BR>public bool CanReadPermissions { get { 
                                return 
                                HasRight(FileSystemRights.ReadPermissions); } 
                                }<BR>public bool CanSynchronize { get { return 
                                HasRight(FileSystemRights.Synchronize); } 
                                }<BR>public bool CanTakeOwnership { get { return 
                                HasRight(FileSystemRights.TakeOwnership); } 
                                }<BR>public bool CanTraverse { get { return 
                                HasRight(FileSystemRights.Traverse); } 
                                }<BR>public bool CanWrite { get { return 
                                HasRight(FileSystemRights.Write); } }<BR>public 
                                bool CanWriteAttributes { get { return 
                                HasRight(FileSystemRights.WriteAttributes); } 
                                }<BR>public bool CanWriteData { get { return 
                                HasRight(FileSystemRights.WriteData); } 
                                }<BR>public bool CanWriteExtendedAttributes { 
                                get { return 
                                HasRight(FileSystemRights.WriteExtendedAttributes); 
                                } }<BR><BR>private void 
                                AssignAccessRight(System.Security.AccessControl.FileSystemAccessRule 
                                rule)<BR>{<BR>if 
                                (System.Security.AccessControl.AccessControlType.Deny.Equals(rule.AccessControlType))<BR>_accessCode 
                                &amp;= (~((int)rule.FileSystemRights));<BR>else 
                                if 
                                (System.Security.AccessControl.AccessControlType.Allow.Equals(rule.AccessControlType))<BR>_accessCode 
                                |= 
                                (int)rule.FileSystemRights;<BR>}<BR><BR>private 
                                void GetAccessRights(string path, 
                                System.Security.Principal.WindowsIdentity 
                                principal)<BR>{<BR>//Reset access code. No 
                                rights to anything.<BR>_accessCode = 
                                0;<BR><BR>try<BR>{<BR>AuthorizationRuleCollection 
                                authorizationRules = (new 
                                System.IO.FileInfo(path)).GetAccessControl().GetAccessRules(true, 
                                true, 
                                typeof(SecurityIdentifier));<BR><BR>foreach 
                                (System.Security.AccessControl.FileSystemAccessRule 
                                rule in authorizationRules)<BR>{<BR>if 
                                (principal.User.Equals(rule.IdentityReference))<BR>this.AssignAccessRight(rule);<BR>}<BR><BR>//A 
                                user can belong to multiple 
                                groups.<BR>IdentityReferenceCollection groups = 
                                _principal.Groups;<BR>for (int i = 0; i &lt; 
                                groups.Count; i++)<BR>{<BR>foreach 
                                (System.Security.AccessControl.FileSystemAccessRule 
                                rule in authorizationRules)<BR>{<BR>if 
                                (groups[i].Equals(rule.IdentityReference))<BR>AssignAccessRight(rule);<BR>}<BR>}<BR>}<BR>catch<BR>{<BR>//Do 
                                nothing here...<BR>}<BR>}<BR><BR>public override 
                                String 
                                ToString()<BR>{<BR>System.Text.StringBuilder b = 
                                new 
                                System.Text.StringBuilder();<BR><BR>foreach(string 
                                s in 
                                System.Enum.GetNames(typeof(System.Security.AccessControl.FileSystemRights)))<BR>{<BR>if 
                                (HasRight((System.Security.AccessControl.FileSystemRights)System.Enum.Parse(typeof(System.Security.AccessControl.FileSystemRights), 
                                s)))<BR>b.AppendFormat("{0}{1}", b.Length == 0 ? 
                                string.Empty : ", ", s);<BR>}<BR><BR>if 
                                (b.Length == 0)<BR>return "None";<BR><BR>return 
                                b.ToString();<BR>}<BR>} 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1587457">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1587457">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1587457&amp;forumid=315432&amp;select=1587457#xx1587457xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1587457#xx1587457xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(718003,1587457);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1580534_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1580534xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1580534#xx1580534xx" 
                                name=1580534><B>Really, really 
                                Useful</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=84133"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>jeff@jgaines.co.uk</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:23 17 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1580534_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you very much, enormously useful!<BR>If you have 
                                no objections I would like to use your class in 
                                my dual pane file manager to control drag and 
                                drop.<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1580534">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1580534">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1580534&amp;forumid=315432&amp;select=1580534#xx1580534xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1580534#xx1580534xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(84133,1580534);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1577134_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1577134xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1577134#xx1577134xx" 
                                name=1577134><B>Great work!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=8749"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Anders 
                                Dalvander</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>3:32 14 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1577134_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Great 
                                work, really good class. Perhaps the ToString 
                                method should use a StringBuilder instead of 
                                appending to a string, which is slow. And to be 
                                more similar to the .NET classes the canXXX 
                                methods should perhaps be converted to 
                                properties. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1577134">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1577134">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1577134&amp;forumid=315432&amp;select=1577134#xx1577134xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1577134#xx1577134xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(8749,1577134);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1529376_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1529376xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1529376#xx1529376xx" 
                                name=1529376><B>Thanks a lot !</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1444857"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>babelweb</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:59 13 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1529376_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>There 
                                is a lot of time that I was annoyed by R/W 
                                access failing (due to hosting company resetting 
                                right access without notice). It's 
                                over!<BR><BR>I just added (an error 3 was thrown 
                                when Directory didn't exist and I found that was 
                                not correctly explaining the reason of the 
                                error):<BR><BR>if (Directory.Exists(_path) == 
                                false) {<BR>throw new 
                                DirectoryNotFoundException();<BR>}<BR><BR><BR>Didier<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1529376">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1529376">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1529376&amp;forumid=315432&amp;select=1529376#xx1529376xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1529376#xx1529376xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1444857,1529376);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1></TD></TR>
                          <TR id=1525450_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1525450xx></A><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;forumid=315432&amp;select=1525450#xx1525450xx" 
                                name=1525450><B>Smoke'n!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=880352"><IMG 
                                title="Click for User Profile" height=15 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Marc 
                                Leger</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>1:48 10 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1525450_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                very much for this util. Will come in handy in 
                                my current project! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1525450">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/UserFileAccessRights.asp&amp;df=100&amp;forumid=315432&amp;select=1525450">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?df=100&amp;tid=1525450&amp;forumid=315432&amp;select=1525450#xx1525450xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/UserFileAccessRights.asp?msg=1525450#xx1525450xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(880352,1525450);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 22:50 Monday 
                              5th February, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 13 Jul 2006 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  Bruce Hatt, 2006<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web15 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Testing file access rights in _NET 2_0 - The Code Project - C# Samples_archivos/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
