
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title id='Description'>In this demo the jqxTree is built from JSON data.</title>
    <link rel="stylesheet" href="/jqwidgets/styles/jqx.base.css" type="text/css" />
    <script type="text/javascript" src="/scripts/gettheme.js"></script>
    <script type="text/javascript" src="/scripts/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxcore.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxdata.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxbuttons.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxscrollbar.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxpanel.js"></script>
    <script type="text/javascript" src="/jqwidgets/jqxtree.js"></script>
        <script type="text/javascript" src="/jqwidgets/jqxexpander.js"></script>
</head>
<body class='default'>

        <script type="text/javascript">
            $(document).ready(function () {
                var theme = getDemoTheme();
                $('#jqxExpander').jqxExpander({ showArrow: false, toggleMode: 'none', width: '300px', height: '360px', theme: theme });

                varUrl = "/service/wcf_service.svc/RetriveCategories";
                varData = '{}';
                $.ajax({
                    type: "POST",
                    url: varUrl,
                    data: varData,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    processdata: true,
                    success: function (data) {

                        ServiceSucceeded(data);
                    },
                    error: ServiceFailed
                });

            });


            
        function ServiceSucceeded(result) {
            var theme = getDemoTheme();
            var data = new Array();
            var totalprice = 0;
            var list = result.RetriveCategoriesResult;
            var data = list;

            // prepare the data
            var source =
                {
                    datatype: "json",
                    datafields: [
                        { name: 'Id' },
                        { name: 'ParentId' },
                        { name: 'Text' },
                        { name: 'Value' }
                    ],
                    id: 'Id',
                    localdata: data
                };

            // create data adapter.
            var dataAdapter = new $.jqx.dataAdapter(source);
            // perform Data Binding.
            dataAdapter.dataBind();
            // get the tree items. The first parameter is the item's id. The second parameter is the parent item's id. The 'items' parameter represents 
            // the sub items collection name. Each jqxTree item has a 'label' property, but in the JSON data, we have a 'text' field. The last parameter 
            // specifies the mapping between the 'text' and 'label' fields.  
            var records = dataAdapter.getRecordsHierarchy('Id', 'ParentId', 'items', [{ name: 'Text', map: 'label'}]);

            // Create jqxExpander
            
         
            $('#jqxTree').jqxTree({ source: records, width: '300px', theme: theme });

        }

        function ServiceFailed(result) {
            alert('Service call failed: ' + result.status + '' + result.statusText);

        }
        </script>
    <div id='jqxWidget'>
        <div id='jqxExpander'>
            <div>
                Folders
            </div>
            <div style="border: none;" id="jqxTree">
            </div>
        </div>
    </div>
</body>
</html>
